<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>MiniR√©seau ‚Äî Exemple de page</title>

  <!-- Lien vers le fichier CSS -->
  <link rel="stylesheet" href="style_site.css">

  
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <div class="dot">MR</div>
        <div class="name"><strong>MiniR√©seau</strong><div class="small">Un prototype social</div></div>
      </div>
      <div class="search">
        <input id="searchInput" placeholder="Rechercher personnes ou posts..." />
      </div>
      <div class="nav-actions">
        <button class="btn" id="notifyBtn">üîî <span id="notifCount" style="margin-left:6px">0</span></button>
        <button class="btn" id="newPostBtn">‚ûï Nouveau</button>
      </div>
    </header>

    <!-- Left column -->
    <aside>
      <div class="card">
        <div class="profile">
          <div class="avatar" id="myAvatar">TU</div>
          <div>
            <div id="myName"><strong>Utilisateur Demo</strong></div>
            <div class="muted">@demo ¬∑ Membre</div>
          </div>
        </div>
        <nav class="menu">
          <button onclick="showTab('feed')">üè† Fil</button>
          <button onclick="showTab('messages')">üí¨ Messages</button>
          <button onclick="showTab('friends')">üë• Amis</button>
          <button onclick="showTab('profile')">üßæ Profil</button>
        </nav>
      </div>

      <div style="height:12px"></div>

      <div class="card small">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><strong>Statistiques</strong></div>
          <div class="muted">en local</div>
        </div>
        <div style="display:flex;gap:8px;margin-top:10px">
          <div class="pill">Posts <div id="statPosts" style="font-weight:700">0</div></div>
          <div class="pill">Amis <div id="statFriends" style="font-weight:700">0</div></div>
        </div>
      </div>
    </aside>

    <!-- Middle: feed -->
    <main>
      <div class="card composer">
        <textarea id="composer" placeholder="Quoi de neuf ?"></textarea>
        <div class="row">
          <div class="small muted">Vous pouvez publier du texte et des hashtags (#) ‚Äî prototype.</div>
          <div style="display:flex;gap:8px">
            <button class="btn" id="clearBtn">Effacer</button>
            <button class="btn" id="publishBtn">Publier</button>
          </div>
        </div>
      </div>

      <div class="feed" id="feed"></div>
      <div id="emptyFeed" class="center muted" style="padding:20px;display:none">Aucun post pour l'instant ‚Äî soyez le premier !</div>
    </main>

    <!-- Right column -->
    <aside class="right-section">
      <div class="card">
        <strong>Suggestions</strong>
        <div class="suggest" id="suggestions"></div>
      </div>

      <div class="card small">
        <strong>Raccourcis</strong>
        <div style="display:flex;flex-direction:column;gap:6px;margin-top:8px">
          <button class="btn" onclick="seedSample()">G√©n√©rer exemple</button>
          <button class="btn" onclick="clearAll()">R√©initialiser</button>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // Mini r√©seau social en JS pur ‚Äî stockage local + interactions basiques
    const STORAGE_KEY = 'minireseau:v1';

    // DOM
    const feedEl = document.getElementById('feed');
    const composer = document.getElementById('composer');
    const publishBtn = document.getElementById('publishBtn');
    const clearBtn = document.getElementById('clearBtn');
    const suggestionsEl = document.getElementById('suggestions');
    const statPosts = document.getElementById('statPosts');
    const statFriends = document.getElementById('statFriends');
    const notifCount = document.getElementById('notifCount');

    // State
    let state = {me:{name:'Utilisateur Demo',handle:'@demo'},posts:[],friends:[],notifications:[]};

    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); updateStats(); }
    function load(){ const s = localStorage.getItem(STORAGE_KEY); if(s){ try{state=JSON.parse(s);}catch(e){console.warn('parse err',e)} } updateStats(); }

    function updateStats(){ statPosts.textContent = state.posts.length; statFriends.textContent = state.friends.length; notifCount.textContent = state.notifications.length; }

    function formatTime(ts){ const d=new Date(ts); return d.toLocaleString(); }

    // Render
    function renderFeed(filter=""){ feedEl.innerHTML=''; let posts = state.posts.slice().sort((a,b)=>b.ts-a.ts);
      if(filter) posts = posts.filter(p=>p.text.toLowerCase().includes(filter) || (p.author && p.author.toLowerCase().includes(filter)) );
      if(posts.length===0){ document.getElementById('emptyFeed').style.display='block'; return } else document.getElementById('emptyFeed').style.display='none';
      posts.forEach(p=>{ const el = document.createElement('article'); el.className='post'; el.innerHTML = `
        <div class="meta"><div class="avatar">${p.authorInitials||'U'}</div>
        <div><div class="name">${escapeHtml(p.authorName||state.me.name)} <span class="small muted">${p.authorHandle||state.me.handle} ¬∑ ${formatTime(p.ts)}</span></div></div></div>
        <div class="content">${linkify(escapeHtml(p.text))}</div>
        <div class="actions small">
          <button class="btn" onclick='toggleLike("${p.id}")'>‚ù§ ${p.likes||0}</button>
          <button class="btn" onclick='openComments("${p.id}")'>üí¨ ${p.comments?.length||0}</button>
          <button class="btn" onclick='sharePost("${p.id}")'>üîó Partager</button>
          <button class="btn" onclick='deletePost("${p.id}")'>üóëÔ∏è Supprimer</button>
        </div>
        <div id="comments-${p.id}" style="margin-top:8px;display:none"></div>
      `; feedEl.appendChild(el);
      }); }

    // Helpers
    function uid(){ return Math.random().toString(36).slice(2,9); }
    function escapeHtml(s){ return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
    function linkify(s){ return s.replace(/(https?:\/\/[^\s]+)/g, '<a target="_blank" href="$1">$1</a>').replace(/#(\w+)/g,'<span class="pill">#$1</span>'); }

    // Actions
    publishBtn.addEventListener('click', ()=>{
      const text = composer.value.trim(); if(!text) return alert('Le message est vide.');
      const p = {id:uid(),text,ts:Date.now(),likes:0,comments:[],authorName:state.me.name,authorHandle:state.me.handle,authorInitials:getInitials(state.me.name)};
      state.posts.push(p); save(); renderFeed(); composer.value=''; notify('Votre post a √©t√© publi√©');
    });
    clearBtn.addEventListener('click', ()=>composer.value='');

    function deletePost(id){ if(!confirm('Supprimer ce post ?')) return; state.posts = state.posts.filter(p=>p.id!==id); save(); renderFeed(); }
    function toggleLike(id){ const p = state.posts.find(x=>x.id===id); if(!p) return; p.likes = (p.likes||0)+1; save(); renderFeed(); }
    function openComments(id){ const cEl = document.getElementById('comments-'+id); if(!cEl) return; cEl.style.display = cEl.style.display==='none'?'block':'none'; if(cEl.innerHTML===''){ const p = state.posts.find(x=>x.id===id); cEl.innerHTML = renderCommentsSection(p); }
    }
    function renderCommentsSection(post){ return `
      <div style="display:flex;gap:8px"><input id="cinput-${post.id}" style="flex:1;padding:8px;border-radius:8px;border:0;background:var(--glass)" placeholder="√âcrire un commentaire..." />
      <button class="btn" onclick='addComment("${post.id}")'>Envoyer</button></div>
      <div style="margin-top:8px">${(post.comments||[]).map(c=>`<div class="small" style="padding:6px 0;border-top:1px dashed rgba(255,255,255,0.02)"><strong>${escapeHtml(c.author)}</strong> <span class="muted">¬∑ ${formatTime(c.ts)}</span><div>${escapeHtml(c.text)}</div></div>`).join('')}</div>
    `}
    function addComment(id){ const input = document.getElementById('cinput-'+id); if(!input) return; const text = input.value.trim(); if(!text) return; const post = state.posts.find(p=>p.id===id); post.comments = post.comments||[]; post.comments.push({id:uid(),author:state.me.name,text,ts:Date.now()}); save(); renderFeed(); notify('Commentaire ajout√©'); }

    function sharePost(id){ const url = new URL(location.href); url.hash = 'post-'+id; navigator.clipboard?.writeText(url.toString()).then(()=>notify('Lien copi√©')); }

    function notify(msg){ state.notifications.push({id:uid(),text:msg,ts:Date.now()}); save(); }

    // Suggestions & friends
    function renderSuggestions(){ suggestionsEl.innerHTML=''; const pool = ['Alice','Bob','Carole','Denis','Eva','Franck']; pool.forEach(name=>{ const id = name.toLowerCase(); const row = document.createElement('div'); row.className='follow-row'; row.innerHTML = `<div><strong>${name}</strong><div class="muted">@${id}</div></div><div><button class="btn" onclick='follow("${name}")'>Suivre</button></div>`; suggestionsEl.appendChild(row); }); }
    function follow(name){ if(state.friends.includes(name)){ alert('D√©j√† suivi'); return } state.friends.push(name); save(); renderSuggestions(); notify('Nouvel ami: '+name); }

    // Seed sample posts
    function seedSample(){ const samples = [
      {text:'Bienvenue sur MiniR√©seau ! #hello #prototype',authorName:'Alice',authorHandle:'@alice'},
      {text:'Un exemple de post avec un lien https://example.com',authorName:'Bob',authorHandle:'@bob'},
      {text:'On teste les r√©actions et commentaires. Qui veut discuter JS ? #javascript',authorName:'Carole',authorHandle:'@carole'}
    ]; samples.forEach(s=>{ state.posts.push(Object.assign({id:uid(),ts:Date.now()-Math.floor(Math.random()*1000*60*60),likes:Math.floor(Math.random()*8),comments:[],authorInitials:getInitials(s.authorName)},s)); }); save(); renderFeed(); }

    function clearAll(){ if(!confirm('Tout r√©initialiser (stockage local) ?')) return; localStorage.removeItem(STORAGE_KEY); state={me:state.me,posts:[],friends:[],notifications:[]}; save(); renderFeed(); }

    // Utilities
    function getInitials(name){ return name.split(' ').map(n=>n[0]).slice(0,2).join('').toUpperCase(); }

    // Search
    document.getElementById('searchInput').addEventListener('input', (e)=>{ renderFeed(e.target.value.toLowerCase()); });

    // Notifications simulation
    setInterval(()=>{
      if(Math.random()>0.8){ const msg = ['Quelqu\'un a aim√© votre post','Nouvelle suggestion d\'ami','Nouveau message priv√©'][Math.floor(Math.random()*3)]; notify(msg); updateNotifUI(); }
    },60000);

    function updateNotifUI(){ notifCount.textContent = state.notifications.length; }

    // On load
    load(); renderSuggestions(); renderFeed(); updateNotifUI();

    // Expose for buttons in HTML inline handlers
    window.seedSample = seedSample; window.clearAll = clearAll; window.showTab = function(t){ alert('Onglet: '+t+' (prototype)') };
    window.toggleLike = toggleLike; window.openComments = openComments; window.addComment = addComment; window.sharePost = sharePost; window.deletePost = deletePost; window.follow = follow; window.getInitials = getInitials;
  </script>
</body>
</html>
